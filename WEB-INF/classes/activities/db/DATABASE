CREATE DATABASE B2B;
USE B2B;

DROP TABLE IF EXISTS INCIDENCIAS;
DROP TABLE IF EXISTS RESERVAS;
DROP TABLE IF EXISTS BOXES;
DROP TABLE IF EXISTS USUARIOS; 


CREATE TABLE USUARIOS (NIA VARCHAR(9) NOT NULL,Nombre VARCHAR(32) NOT NULL, Apellido VARCHAR(32) NOT NULL, Mail VARCHAR(45) NOT NULL, Password VARCHAR(12) NOT NULL, Admin BOOLEAN NOT NULL, Telephone VARCHAR(10), PRIMARY KEY (NIA));
CREATE TABLE BOXES (Id_BOX INT NOT NULL AUTO_INCREMENT, Size INT NOT NULL, PRIMARY KEY (Id_BOX));
CREATE TABLE RESERVAS (Id_Res INT UNSIGNED NOT NULL AUTO_INCREMENT,Fecha VARCHAR(15) NOT NULL, Horario_Inicio VARCHAR(15) NOT NULL, Horario_Fin VARCHAR(15) NOT NULL, Confirmed BOOLEAN NOT NULL, User_NIA VARCHAR(9) NOT NULL,Box_id INT NOT NULL, PRIMARY KEY(Id_Res),FOREIGN KEY (User_NIA) REFERENCES USUARIOS (NIA) ON DELETE CASCADE,FOREIGN KEY (Box_id) REFERENCES BOXES (Id_BOX) ON DELETE CASCADE);
CREATE TABLE INCIDENCIAS ( Id_Inc INT UNSIGNED NOT NULL AUTO_INCREMENT,Id_Reserv INT UNSIGNED NOT NULL,  Cause VARCHAR(20), Description VARCHAR(60), PRIMARY KEY (Id_Inc),FOREIGN KEY (Id_Reserv) REFERENCES RESERVAS (Id_Res) ON DELETE RESTRICT);

INSERT INTO USUARIOS (NIA,Nombre,Apellido,Mail,Password,Admin,Telephone) VALUES ('user','Ignacio','Sanchez','hola@gmail.es','user',False,'51651351');
INSERT INTO USUARIOS (NIA,Nombre,Apellido,Mail,Password,Admin,Telephone) VALUES ('admin','Ignacio','Sanchez','hola@gmail.es','admin',True,'51651351');
INSERT INTO USUARIOS (NIA,Nombre,Apellido,Mail,Password,Admin,Telephone) VALUES ('999999988','Ignacio','Sanchez','hola@gmail.es','ignacio',False,'51651351');
INSERT INTO USUARIOS (NIA,Nombre,Apellido,Mail,Password,Admin,Telephone) VALUES ('955999988','Gaspar','Avit','adios@gmail.es','gaspar',False,'51651351');
INSERT INTO USUARIOS (NIA,Nombre,Apellido,Mail,Password,Admin,Telephone) VALUES ('127999945','Adri√°n','de la Torre','buenas@gmail.es','adrian',False,'65845351');
INSERT INTO USUARIOS (NIA,Nombre,Apellido,Mail,Password,Admin,Telephone) VALUES ('127975988','Pablo','noseque','quetal@gmail.es','pablo',False,'65485351');
INSERT INTO USUARIOS (NIA,Nombre,Apellido,Mail,Password,Admin,Telephone) VALUES ('127999984','Gorka','Antona','sisisl@gmail.es','gorka',True,'48485351');

INSERT INTO BOXES ( Size) VALUES ('10');
INSERT INTO BOXES ( Size) VALUES ('8');
INSERT INTO BOXES ( Size) VALUES ('7');
INSERT INTO BOXES ( Size) VALUES ('12');
INSERT INTO BOXES ( Size) VALUES ('15');
INSERT INTO BOXES ( Size) VALUES ('5');
INSERT INTO BOXES ( Size) VALUES ('8');
INSERT INTO BOXES ( Size) VALUES ('19');
INSERT INTO BOXES ( Size) VALUES ('3');
INSERT INTO BOXES ( Size) VALUES ('20');
